<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.7px Arial; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;title&gt;Recital Architect Prototype&lt;/title&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;style&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â :root {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â --bg-color: #f4f4f9;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â --panel-bg: #ffffff;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â --header-bg: #e0e0e6;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â --border-color: #d1d1d6;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â --text-color: #333;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â --accent-color: #007aff;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â --accent-light: #e6f2ff;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â body {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin: 0;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â padding: 20px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â background-color: var(--bg-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â color: var(--text-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â h1, h2 {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â font-weight: 500;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .container {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â display: grid;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â grid-template-columns: 1fr 2fr;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â grid-template-rows: auto 1fr;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â gap: 20px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â max-width: 1200px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin: auto;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â height: 85vh;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .panel {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â background-color: var(--panel-bg);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border: 1px solid var(--border-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 8px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â padding: 15px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â overflow-y: auto;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â box-shadow: 0 2px 4px rgba(0,0,0,0.05);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â #filter-panel { grid-column: 1 / 2; grid-row: 1 / 3; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â #programme-builder { grid-column: 2 / 3; grid-row: 1 / 3; display: flex; flex-direction: column; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â #results-panel {Â </span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â grid-column: 1 / 2;Â </span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â grid-row: 2 / 3;Â </span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin-top: -85vh; /* A bit of a layout trick to make it look like 3 panels */</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â padding-top: 50%;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .filter-group { margin-bottom: 20px; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .filter-group h3 { margin-top: 0; margin-bottom: 10px; font-size: 16px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .filter-group label {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â display: block;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin-bottom: 8px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â cursor: pointer;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .result-item, .programme-item, .event-block {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â padding: 10px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border: 1px solid var(--border-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 5px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin-bottom: 10px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â background-color: var(--bg-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .result-item { cursor: grab; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .result-item:active { cursor: grabbing; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .result-item strong, .programme-item strong { display: block; font-size: 1.1em; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .result-item em, .programme-item em { color: #555; font-size: 0.9em; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .programme-list { flex-grow: 1; min-height: 200px; padding: 10px; border: 2px dashed var(--border-color); border-radius: 5px; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .programme-item .controls { float: right; cursor: pointer; font-weight: bold; }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .programme-total {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â padding-top: 15px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin-top: 15px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border-top: 1px solid var(--border-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â font-size: 1.2em;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â font-weight: bold;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .event-buttons button {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â padding: 8px 12px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border: 1px solid var(--accent-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â background-color: transparent;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â color: var(--accent-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 5px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â cursor: pointer;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin-right: 10px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin-bottom: 10px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .event-buttons button:hover { background-color: var(--accent-light); }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â .event-block input[type="text"], .event-block input[type="number"] {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border: 1px solid var(--border-color);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â padding: 5px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 3px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â margin-right: 5px;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;div class="container"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â &lt;div id="filter-panel" class="panel"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;h2&gt;ðŸŽ¹ Filters&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;div id="filters"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â &lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â &lt;div id="programme-builder" class="panel"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;h2&gt;ðŸŽ¼ Programme Builder&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="event-buttons"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;button id="add-talk-btn"&gt;+ Add Spoken Section&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;button id="add-interval-btn"&gt;+ Add Interval&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;div id="programme-list" class="programme-list"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;div id="programme-total" class="programme-total"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Total Time: 00:00</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â &lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â &lt;div id="results-panel" class="panel"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;h2&gt;ðŸ“– Results&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â &lt;div id="results"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;script&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â // --- DATABASE ---</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â const repertoireDB = [</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â { id: 1, title: "Oblivion", composer: "Astor Piazzolla", duration: 240, moods: ["Melancholy", "Passionate"], tempo: "Slow", instrumentation: ["Clarinet", "Piano"], style: ["20th Century", "Argentinian", "Tango Nuevo"] },</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â { id: 2, title: "Histoire du Tango - Cafe 1930", composer: "Astor Piazzolla", duration: 390, moods: ["Melancholy", "Passionate", "Playful"], tempo: "Moderate", instrumentation: ["Clarinet", "Piano"], style: ["20th Century", "Argentinian", "Tango Nuevo"] },</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â { id: 3, title: "Canzonetta", composer: "Gabriel PiernÃ©", duration: 210, moods: ["Playful", "Peaceful"], tempo: "Moderate", instrumentation: ["Clarinet", "Piano"], style: ["Romantic", "French"] },</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â { id: 4, title: "Arabesque No. 1", composer: "Claude Debussy", duration: 270, moods: ["Peaceful", "Playful", "Dreamy"], tempo: "Moderate", instrumentation: ["Clarinet", "Piano"], style: ["Impressionist", "French"] }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â ];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â let programme = [];</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â let nextEventId = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â // --- FILTER GENERATION ---</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â const filtersContainer = document.getElementById('filters');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â const filterCategories = {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â moods: [...new Set(repertoireDB.flatMap(p =&gt; p.moods))],</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â tempo: [...new Set(repertoireDB.map(p =&gt; p.tempo))],</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â instrumentation: [...new Set(repertoireDB.flatMap(p =&gt; p.instrumentation))],</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â style: [...new Set(repertoireDB.flatMap(p =&gt; p.style))]</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â for (const category in filterCategories) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const group = document.createElement('div');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â group.className = 'filter-group';</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const title = document.createElement('h3');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â title.textContent = category.charAt(0).toUpperCase() + category.slice(1);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â group.appendChild(title);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â filterCategories[category].forEach(option =&gt; {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const label = document.createElement('label');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const checkbox = document.createElement('input');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â checkbox.type = 'checkbox';</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â checkbox.value = option;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â checkbox.dataset.category = category;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â checkbox.addEventListener('change', renderResults);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â label.appendChild(checkbox);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â label.append(` ${option}`);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â group.appendChild(label);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â });</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â filtersContainer.appendChild(group);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â // --- RENDERING FUNCTIONS ---</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â function formatTime(seconds) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const min = Math.floor(seconds / 60).toString().padStart(2, '0');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const sec = (seconds % 60).toString().padStart(2, '0');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â return `${min}:${sec}`;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â function renderResults() {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const resultsContainer = document.getElementById('results');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â resultsContainer.innerHTML = '';</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â </span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const activeFilters = {};</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â document.querySelectorAll('#filters input:checked').forEach(input =&gt; {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (!activeFilters[input.dataset.category]) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â activeFilters[input.dataset.category] = [];</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â activeFilters[input.dataset.category].push(input.value);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const filteredDB = repertoireDB.filter(piece =&gt; {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â return Object.entries(activeFilters).every(([category, values]) =&gt; {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (values.length === 0) return true;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (Array.isArray(piece[category])) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â return values.some(v =&gt; piece[category].includes(v));</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â return values.includes(piece[category]);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â });</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â filteredDB.forEach(piece =&gt; {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const div = document.createElement('div');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.className = 'result-item';</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.draggable = true;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.dataset.pieceId = piece.id;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.innerHTML = `&lt;strong&gt;${piece.title}&lt;/strong&gt;&lt;em&gt;${piece.composer} (${formatTime(piece.duration)})&lt;/em&gt;`;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.addEventListener('dragstart', handleDragStart);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resultsContainer.appendChild(div);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â });</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â function renderProgramme() {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const programmeList = document.getElementById('programme-list');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â programmeList.innerHTML = '';</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â </span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â programme.forEach((item, index) =&gt; {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const div = document.createElement('div');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.dataset.index = index;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.draggable = true;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.addEventListener('dragstart', handleProgrammeDragStart);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (item.type === 'piece') {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.className = 'programme-item';</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.innerHTML = `&lt;span class="controls" onclick="removeFromProgramme(${index})"&gt;âœ–&lt;/span&gt;&lt;strong&gt;${item.title}&lt;/strong&gt;&lt;em&gt;${item.composer} (${formatTime(item.duration)})&lt;/em&gt;`;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } else { // event block</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.className = 'event-block';</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â div.innerHTML = `</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span class="controls" onclick="removeFromProgramme(${index})"&gt;âœ–&lt;/span&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;input type="text" value="${item.title}" onchange="updateEvent(${index}, 'title', this.value)"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Duration (min): &lt;input type="number" value="${item.duration / 60}" step="0.5" min="0" onchange="updateEvent(${index}, 'duration', this.value * 60)"&gt;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â `;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â programmeList.appendChild(div);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â });</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â updateTotalTime();</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â function updateTotalTime() {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const totalSeconds = programme.reduce((sum, item) =&gt; sum + item.duration, 0);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â document.getElementById('programme-total').textContent = `Total Time: ${formatTime(totalSeconds)}`;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â // --- EVENT HANDLERS &amp; LOGIC ---</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â function handleDragStart(e) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â e.dataTransfer.setData('text/plain', e.target.dataset.pieceId);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â function handleProgrammeDragStart(e) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â e.dataTransfer.setData('text/programme-index', e.target.dataset.index);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â </span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â const programmeList = document.getElementById('programme-list');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â programmeList.addEventListener('dragover', e =&gt; e.preventDefault());</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â programmeList.addEventListener('drop', handleDrop);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â function handleDrop(e) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â e.preventDefault();</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const pieceId = e.dataTransfer.getData('text/plain');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â const programmeIndex = e.dataTransfer.getData('text/programme-index');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â if (pieceId) { // Dropping a new piece</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const piece = repertoireDB.find(p =&gt; p.id == pieceId);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (piece) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â programme.push({ ...piece, type: 'piece' });</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â } else if (programmeIndex) { // Reordering within programme</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const draggedItem = programme.splice(programmeIndex, 1)[0];</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const dropTarget = e.target.closest('.programme-item, .event-block');</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const dropIndex = dropTarget ? dropTarget.dataset.index : programme.length;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â programme.splice(dropIndex, 0, draggedItem);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â renderProgramme();</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â </span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â window.removeFromProgramme = function(index) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â programme.splice(index, 1);</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â renderProgramme();</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â window.updateEvent = function(index, field, value) {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â programme[index][field] = value;</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â updateTotalTime();</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â document.getElementById('add-talk-btn').addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â programme.push({ id: `evt-${nextEventId++}`, type: 'event', title: 'Spoken Section', duration: 120 });</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â renderProgramme();</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â });</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â </span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â document.getElementById('add-interval-btn').addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â programme.push({ id: `evt-${nextEventId++}`, type: 'event', title: 'Interval', duration: 900 });</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â Â Â Â Â renderProgramme();</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â // --- INITIAL RENDER ---</span></p>
<p class="p1"><span class="s1">Â Â Â Â Â Â Â Â renderResults();</span></p>
<p class="p1"><span class="s1">Â Â Â Â &lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
</body>
</html>
